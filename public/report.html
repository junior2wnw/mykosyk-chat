<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–æ–æ–±—â–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É | –°–ª–µ–π –≤—Å—ë - –ü–æ–ª—É—á–∏ –ø–æ–º–æ—â—å —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</title>
    <meta name="description" content="–ê–Ω–æ–Ω–∏–º–Ω–æ —Ä–∞—Å—Å–∫–∞–∂–∏ –æ —Å–≤–æ–µ–π –ø—Ä–æ–±–ª–µ–º–µ –∏ –ø–æ–ª—É—á–∏ —Å–æ–≤–µ—Ç—ã –æ—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–∞. –ë—ã—Å—Ç—Ä–æ, –±–µ–∑–æ–ø–∞—Å–Ω–æ, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ.">
    
    <!-- Open Graph -->
    <meta property="og:title" content="–°–æ–æ–±—â–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É | –°–ª–µ–π –≤—Å—ë">
    <meta property="og:description" content="–ü–æ–ª—É—á–∏ –ø–æ–º–æ—â—å —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ —Å –ª—é–±–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π">
    <meta property="og:url" content="https://mykosyk.ru/report">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://mykosyk.ru/og-report.png">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="–°–æ–æ–±—â–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É | –°–ª–µ–π –≤—Å—ë">
    <meta name="twitter:description" content="–ê–Ω–æ–Ω–∏–º–Ω–∞—è –ø–æ–º–æ—â—å —Å –ª—é–±–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π">
    <meta name="twitter:image" content="https://mykosyk.ru/og-report.png">
    
    <link rel="canonical" href="https://mykosyk.ru/report">
    <link rel="stylesheet" href="style.css">
    
    <!-- JSON-LD -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "name": "–°–æ–æ–±—â–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É - –°–ª–µ–π –≤—Å—ë",
      "description": "–§–æ—Ä–º–∞ –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–æ–±–ª–µ–º –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–º–æ—â–∏ –æ—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–∞",
      "url": "https://mykosyk.ru/report",
      "mainEntity": {
        "@type": "ContactPage",
        "name": "–§–æ—Ä–º–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–µ"
      }
    }
    </script>
</head>
<body>
    <div class="app">
        <header class="header">
            <div class="container">
                <div class="header-content">
                    <h1 class="logo">
                        <a href="/" style="text-decoration: none; color: inherit;">
                            <span class="logo-icon">üìù</span>
                            –°–æ–æ–±—â–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É
                        </a>
                    </h1>
                    <nav>
                        <a href="/" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a>
                        <a href="/ai" class="nav-link">API</a>
                    </nav>
                </div>
            </div>
        </header>

        <main class="main">
            <div class="container">
                
                <div class="report-hero">
                    <h1>üÜò –†–∞—Å—Å–∫–∞–∂–∏ –æ —Å–≤–æ–µ–π –ø—Ä–æ–±–ª–µ–º–µ</h1>
                    <p>–ü–æ–ª—É—á–∏ —Å–æ–≤–µ—Ç –æ—Ç –ª—é–¥–µ–π —Å –ø–æ—Ö–æ–∂–∏–º –æ–ø—ã—Ç–æ–º. –ê–Ω–æ–Ω–∏–º–Ω–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ.</p>
                </div>

                <div class="stats-bar">
                    <div class="stat">
                        <span class="stat-number" id="totalReports">1,247</span>
                        <span class="stat-label">–ø—Ä–æ–±–ª–µ–º —Ä–µ—à–µ–Ω–æ</span>
                    </div>
                    <div class="stat">
                        <span class="stat-number">2.3</span>
                        <span class="stat-label">—á–∞—Å–∞ —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞</span>
                    </div>
                    <div class="stat">
                        <span class="stat-number">94%</span>
                        <span class="stat-label">–ø–æ–ª—É—á–∏–ª–∏ –ø–æ–º–æ—â—å</span>
                    </div>
                </div>

                <div class="report-container">
                    
                    <div class="report-form-section">
                        <form id="reportForm" class="report-form">
                            <div class="form-group">
                                <label for="problemText">–û–ø–∏—à–∏ —Å–≤–æ—é –ø—Ä–æ–±–ª–µ–º—É</label>
                                <textarea 
                                    id="problemText" 
                                    name="text"
                                    placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ù–µ –º–æ–≥—É –Ω–∞–π—Ç–∏ —Ä–∞–±–æ—Ç—É —É–∂–µ 3 –º–µ—Å—è—Ü–∞, –¥–µ–ø—Ä–µ—Å—Å–∏—è –æ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –æ—Ç–∫–∞–∑–æ–≤. –ß—Ç–æ –¥–µ–ª–∞—Ç—å?"
                                    rows="6"
                                    maxlength="2000"
                                    required
                                ></textarea>
                                <div class="char-counter">
                                    <span id="charCount">0</span>/2000
                                </div>
                            </div>

                            <div class="form-group">
                                <label>–í—ã–±–µ—Ä–∏ —Ç–µ–≥–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                                <div class="tags-container">
                                    <div class="tag-chip" data-tag="—Ä–∞–±–æ—Ç–∞">üíº –†–∞–±–æ—Ç–∞</div>
                                    <div class="tag-chip" data-tag="—É—á–µ–±–∞">üìö –£—á–µ–±–∞</div>
                                    <div class="tag-chip" data-tag="—Å–µ–º—å—è">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ –°–µ–º—å—è</div>
                                    <div class="tag-chip" data-tag="–æ—Ç–Ω–æ—à–µ–Ω–∏—è">üíï –û—Ç–Ω–æ—à–µ–Ω–∏—è</div>
                                    <div class="tag-chip" data-tag="–∑–¥–æ—Ä–æ–≤—å–µ">üè• –ó–¥–æ—Ä–æ–≤—å–µ</div>
                                    <div class="tag-chip" data-tag="–¥–µ–Ω—å–≥–∏">üí∞ –î–µ–Ω—å–≥–∏</div>
                                    <div class="tag-chip" data-tag="–¥—Ä—É–∑—å—è">üë´ –î—Ä—É–∑—å—è</div>
                                    <div class="tag-chip" data-tag="–¥–µ–ø—Ä–µ—Å—Å–∏—è">üòî –î–µ–ø—Ä–µ—Å—Å–∏—è</div>
                                    <div class="tag-chip" data-tag="—Ç—Ä–µ–≤–æ–≥–∞">üò∞ –¢—Ä–µ–≤–æ–≥–∞</div>
                                    <div class="tag-chip" data-tag="–∫–∞—Ä—å–µ—Ä–∞">üìà –ö–∞—Ä—å–µ—Ä–∞</div>
                                </div>
                                <div class="selected-tags" id="selectedTags"></div>
                            </div>

                            <div class="form-group">
                                <label for="contactEmail">Email –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                                <input 
                                    type="email" 
                                    id="contactEmail"
                                    name="contact"
                                    placeholder="your@email.com"
                                >
                                <div class="form-hint">
                                    –ï—Å–ª–∏ —É–∫–∞–∂–µ—à—å email, –ø—Ä–∏—à–ª—ë–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–æ–≥–¥–∞ –ø–æ—è–≤—è—Ç—Å—è —Å–æ–≤–µ—Ç—ã
                                </div>
                            </div>

                            <div class="privacy-notice-small">
                                üîí –¢–≤–æ—è –ø—Ä–æ–±–ª–µ–º–∞ –±—É–¥–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞ –∞–Ω–æ–Ω–∏–º–Ω–æ. Email –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.
                            </div>

                            <button type="submit" class="submit-btn" id="submitBtn" disabled>
                                <span class="btn-text">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É</span>
                                <span class="btn-loader" style="display: none;">–û—Ç–ø—Ä–∞–≤–ª—è—é...</span>
                            </button>
                        </form>
                    </div>

                    <div class="help-sidebar">
                        <div class="help-card">
                            <h3>üí° –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –ª—É—á—à–∏–π —Å–æ–≤–µ—Ç?</h3>
                            <ul>
                                <li><strong>–ë—É–¥—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º</strong> - —á–µ–º –±–æ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π, —Ç–µ–º —Ç–æ—á–Ω–µ–µ —Å–æ–≤–µ—Ç</li>
                                <li><strong>–£–∫–∞–∂–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç</strong> - –≤–æ–∑—Ä–∞—Å—Ç, —Å–∏—Ç—É–∞—Ü–∏—è, —á—Ç–æ —É–∂–µ –ø—Ä–æ–±–æ–≤–∞–ª</li>
                                <li><strong>–í—ã–±–µ—Ä–∏ —Ç–µ–≥–∏</strong> - —Ç–∞–∫ —Ç–≤–æ—é –ø—Ä–æ–±–ª–µ–º—É –Ω–∞–π–¥—É—Ç —ç–∫—Å–ø–µ—Ä—Ç—ã</li>
                                <li><strong>–û—Å—Ç–∞–≤—å email</strong> - –ø–æ–ª—É—á–∏—à—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤—ã—Ö —Å–æ–≤–µ—Ç–∞—Ö</li>
                            </ul>
                        </div>

                        <div class="help-card">
                            <h3>‚ö° –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã</h3>
                            <div class="popular-problems">
                                <a href="/blog/chto-delat-esli-depressiya" class="problem-link">–ö–∞–∫ —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –¥–µ–ø—Ä–µ—Å—Å–∏–µ–π?</a>
                                <a href="/blog/chto-delat-esli-problemy-s-roditelyami" class="problem-link">–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å —Ä–æ–¥–∏—Ç–µ–ª—è–º–∏</a>
                                <a href="/blog/chto-delat-esli-problemy-v-uchebe" class="problem-link">–ü—Ä–æ–±–ª–µ–º—ã –≤ —É—á–µ–±–µ</a>
                                <a href="/blog/chto-delat-esli-problemy-na-rabote" class="problem-link">–°—Ç—Ä–µ—Å—Å –Ω–∞ —Ä–∞–±–æ—Ç–µ</a>
                            </div>
                        </div>

                        <div class="help-card">
                            <h3>üö® –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –ø–æ–º–æ—â—å</h3>
                            <p>–ï—Å–ª–∏ —É —Ç–µ–±—è —Å—É–∏—Ü–∏–¥–∞–ª—å–Ω—ã–µ –º—ã—Å–ª–∏ –∏–ª–∏ –æ—Å—Ç—Ä—ã–π –∫—Ä–∏–∑–∏—Å:</p>
                            <div class="emergency-contacts">
                                <a href="tel:88002000122" class="emergency-link">üìû 8-800-2000-122</a>
                                <span class="emergency-desc">–î–µ—Ç—Å–∫–∏–π —Ç–µ–ª–µ—Ñ–æ–Ω –¥–æ–≤–µ—Ä–∏—è</span>
                            </div>
                        </div>
                    </div>

                </div>

            </div>
        </main>

        <footer class="footer">
            <div class="container">
                <p>¬© 2025 –°–ª–µ–π –≤—Å—ë. –ê–Ω–æ–Ω–∏–º–Ω–æ, –±–µ–∑–æ–ø–∞—Å–Ω–æ, –±–µ–∑ –±—É–ª–ª—à–∏—Ç–∞.</p>
            </div>
        </footer>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!</h2>
            </div>
            <div class="modal-body">
                <p>ID —Ç–≤–æ–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞: <code id="reportId"></code></p>
                <p>–°–∫–æ—Ä–æ –ø–æ–ª—É—á–∏—à—å —Å–æ–≤–µ—Ç—ã –æ—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–∞. –ï—Å–ª–∏ —É–∫–∞–∑–∞–ª email - –ø—Ä–∏—à–ª—ë–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.</p>
                <div class="share-section">
                    <h3>–ü–æ–¥–µ–ª–∏—Å—å —Å –¥—Ä—É–∑—å—è–º–∏:</h3>
                    <div class="share-buttons">
                        <a href="#" id="shareVk" class="share-btn">VK</a>
                        <a href="#" id="shareTg" class="share-btn">Telegram</a>
                        <a href="#" id="shareWa" class="share-btn">WhatsApp</a>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="closeModal()" class="btn btn-primary">–û—Ç–ª–∏—á–Ω–æ!</button>
                <a href="/" class="btn btn-secondary">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
            </div>
        </div>
    </div>

    <style>
        .report-hero {
            text-align: center;
            padding: 3rem 0;
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            margin-bottom: 2rem;
        }

        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-bottom: 3rem;
            padding: 2rem;
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            display: block;
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent-primary);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .report-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .report-form {
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 2rem;
            border: 1px solid var(--border-color);
        }

        .form-group {
            margin-bottom: 2rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-group textarea,
        .form-group input {
            width: 100%;
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-small);
            padding: 1rem;
            color: var(--text-primary);
            font-size: 1rem;
            font-family: inherit;
            transition: var(--transition);
        }

        .form-group textarea:focus,
        .form-group input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: var(--accent-glow);
        }

        .char-counter {
            text-align: right;
            margin-top: 0.5rem;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .tag-chip {
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: 20px;
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
            user-select: none;
        }

        .tag-chip:hover {
            border-color: var(--accent-primary);
        }

        .tag-chip.selected {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: white;
        }

        .selected-tags {
            margin-top: 1rem;
        }

        .form-hint {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
        }

        .privacy-notice-small {
            background: var(--bg-tertiary);
            padding: 1rem;
            border-radius: var(--border-radius-small);
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        .submit-btn {
            background: var(--accent-gradient);
            color: white;
            border: none;
            border-radius: var(--border-radius-small);
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
        }

        .submit-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow-large);
        }

        .submit-btn:disabled {
            background: var(--bg-tertiary);
            cursor: not-allowed;
            opacity: 0.5;
        }

        .help-sidebar .help-card {
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            margin-bottom: 1.5rem;
        }

        .help-card h3 {
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .help-card ul {
            list-style: none;
            padding: 0;
        }

        .help-card li {
            margin-bottom: 0.5rem;
            padding-left: 1rem;
            position: relative;
        }

        .help-card li:before {
            content: "‚Ä¢";
            color: var(--accent-primary);
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        .popular-problems {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .problem-link {
            color: var(--accent-primary);
            text-decoration: none;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .problem-link:hover {
            text-decoration: underline;
        }

        .emergency-contacts {
            text-align: center;
            margin-top: 1rem;
        }

        .emergency-link {
            display: inline-block;
            background: #ff4444;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius-small);
            text-decoration: none;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .emergency-desc {
            display: block;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            border: 1px solid var(--border-color);
        }

        .modal-header h2 {
            margin: 0 0 1rem 0;
            color: var(--text-primary);
        }

        .share-section {
            margin: 1.5rem 0;
            text-align: center;
        }

        .share-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1rem;
        }

        .share-btn {
            background: var(--accent-primary);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius-small);
            text-decoration: none;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .share-btn:hover {
            background: var(--accent-secondary);
        }

        .modal-footer {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .nav-link {
            color: var(--text-secondary);
            text-decoration: none;
            margin-left: 2rem;
            transition: var(--transition);
        }

        .nav-link:hover {
            color: var(--text-primary);
        }

        @media (max-width: 768px) {
            .report-container {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            
            .stats-bar {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .tags-container {
                gap: 0.25rem;
            }
            
            .tag-chip {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }
        }
    </style>

    <script>
        // Form handling
        const form = document.getElementById('reportForm');
        const problemText = document.getElementById('problemText');
        const charCount = document.getElementById('charCount');
        const submitBtn = document.getElementById('submitBtn');
        const tagChips = document.querySelectorAll('.tag-chip');
        const selectedTagsContainer = document.getElementById('selectedTags');
        
        let selectedTags = [];

        // Character counter
        problemText.addEventListener('input', () => {
            const length = problemText.value.length;
            charCount.textContent = length;
            
            if (length > 1800) {
                charCount.style.color = '#ff4444';
            } else if (length > 1500) {
                charCount.style.color = '#ffaa44';
            } else {
                charCount.style.color = 'var(--text-muted)';
            }
            
            checkFormValidity();
        });

        // Tag selection
        tagChips.forEach(chip => {
            chip.addEventListener('click', () => {
                const tag = chip.dataset.tag;
                
                if (selectedTags.includes(tag)) {
                    selectedTags = selectedTags.filter(t => t !== tag);
                    chip.classList.remove('selected');
                } else if (selectedTags.length < 5) {
                    selectedTags.push(tag);
                    chip.classList.add('selected');
                }
                
                updateSelectedTags();
            });
        });

        function updateSelectedTags() {
            selectedTagsContainer.innerHTML = selectedTags.length > 0 
                ? `–í—ã–±—Ä–∞–Ω–æ: ${selectedTags.join(', ')}`
                : '';
        }

        function checkFormValidity() {
            const textValid = problemText.value.trim().length >= 10;
            submitBtn.disabled = !textValid;
        }

        // Form submission
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const btnText = document.querySelector('.btn-text');
            const btnLoader = document.querySelector('.btn-loader');
            
            btnText.style.display = 'none';
            btnLoader.style.display = 'inline';
            submitBtn.disabled = true;

            try {
                const formData = {
                    text: problemText.value.trim(),
                    tags: selectedTags,
                    contact: document.getElementById('contactEmail').value.trim(),
                    referrer: document.referrer,
                    utm_source: new URLSearchParams(window.location.search).get('utm_source')
                };

                const response = await fetch('/api/report', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });

                const result = await response.json();

                if (result.success) {
                    showSuccessModal(result.reportId);
                } else {
                    throw new Error(result.errors?.[0]?.msg || '–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏');
                }

            } catch (error) {
                alert('–û—à–∏–±–∫–∞: ' + error.message);
                btnText.style.display = 'inline';
                btnLoader.style.display = 'none';
                submitBtn.disabled = false;
            }
        });

        function showSuccessModal(reportId) {
            document.getElementById('reportId').textContent = reportId;
            document.getElementById('successModal').style.display = 'flex';
            
            // Setup share buttons
            const problemSummary = problemText.value.substring(0, 100) + '...';
            const shareText = encodeURIComponent(`–ü–æ–¥–µ–ª–∏–ª—Å—è –ø—Ä–æ–±–ª–µ–º–æ–π –Ω–∞ mykosyk.ru –∏ –ø–æ–ª—É—á–∏–ª —Å–æ–≤–µ—Ç! ${problemSummary}`);
            const shareUrl = encodeURIComponent('https://mykosyk.ru/report');
            
            document.getElementById('shareVk').href = `https://vk.com/share.php?url=${shareUrl}&title=${shareText}`;
            document.getElementById('shareTg').href = `https://t.me/share/url?url=${shareUrl}&text=${shareText}`;
            document.getElementById('shareWa').href = `https://wa.me/?text=${shareText} ${shareUrl}`;
        }

        function closeModal() {
            document.getElementById('successModal').style.display = 'none';
            form.reset();
            selectedTags = [];
            tagChips.forEach(chip => chip.classList.remove('selected'));
            updateSelectedTags();
            charCount.textContent = '0';
            checkFormValidity();
        }

        // Load stats
        fetch('/api/stats')
            .then(r => r.json())
            .then(data => {
                if (data.totalReports) {
                    document.getElementById('totalReports').textContent = data.totalReports.toLocaleString();
                }
            })
            .catch(() => {});

        // Analytics
        console.log('ANALYTICS: view_report_page');
        
        // Initial check
        checkFormValidity();
    </script>
</body>
</html>
